import{r as f,j as t,b as p,f as N,h as S,i as F,k as L,l as T,m as b,s as $,n as G,o as q}from"./index-DWflN8ur.js";import{G as B}from"./GridList-B8pwV2JM.js";import{P as O}from"./Pagination-byNl2r29.js";const y="_catalog_qj73c_1",M="_catalogLeft_qj73c_13",P="_catalogBottom_qj73c_19",R="_paginationWrapper_qj73c_25",D="_pagination_qj73c_25",E="_paginationActive_qj73c_35",Q="_paginationNotActive_qj73c_36",W="_rightBlock_qj73c_48",V="_filtersTitle_qj73c_58",v={catalog:y,catalogLeft:M,catalogBottom:P,paginationWrapper:R,pagination:D,paginationActive:E,paginationNotActive:Q,rightBlock:W,filtersTitle:V},w="_filters_1nnku_1",z="_filterTitle_1nnku_11",H="_activeMobile_1nnku_24",J="_filterActive_1nnku_30",K="_filterList_1nnku_66",U="_filterItem_1nnku_107",X="_filterItemActive_1nnku_108",Y="_active_1nnku_24",Z="_clickAnimation_1nnku_134",tt="_click_1nnku_134",e={filters:w,filterTitle:z,activeMobile:H,filterActive:J,filterList:K,filterItem:U,filterItemActive:X,active:Y,clickAnimation:Z,click:tt};function et({onClickItem:o,item:s}){const[c,i]=f.useState(!1),n=r=>{o(r),i(!c)};return t.jsxs("li",{onClick:()=>n(s),className:c?e.filterItemActive:e.filterItem,children:[s.name,s.label]},s.id)}function st({type:o,onClickGenre:s,data:c,placeholder:i}){const n=p(l=>l.catalog.genres),[r,g]=f.useState(!1),[u,m]=f.useState(!1),_=()=>{g(!r),m(!0),setTimeout(()=>{m(!1)},200)};return t.jsxs("div",{className:e.filter,children:[t.jsx("div",{className:e.filterTitle,children:o}),t.jsxs("div",{className:e.filterContent,children:[t.jsx("div",{onClick:_,className:u?`${e.filterActive} ${e.clickAnimation}`:e.filterActive,children:n.length>=1?n.map((l,k)=>k===0||k===-1?l.name:", "+l.name):i}),t.jsx("ul",{className:r?`${e.filterList} ${e.active}`:e.filterList,children:c==null?void 0:c.map(l=>t.jsx(et,{onClickItem:s,item:l},l.id))})]})]})}function it({onClickItem:o,item:s,sortText:c}){const[i,n]=f.useState(!1),r=(g,u)=>{o(g,u),n(!i)};return t.jsxs("li",{onClick:()=>r(s.value,s.label),className:c===s.label?e.filterItemActive:e.filterItem,children:[s.name,s.label]},s.id)}function ct({type:o,onClickSort:s,data:c}){const i=p(_=>_.catalog.sortText),[n,r]=f.useState(!1),[g,u]=f.useState(!1),m=()=>{r(!n),u(!0),setTimeout(()=>{u(!1)},200)};return t.jsxs("div",{className:e.filter,children:[t.jsx("div",{className:e.filterTitle,children:o}),t.jsxs("div",{className:e.filterContent,children:[t.jsx("div",{onClick:m,className:g?`${e.filterActive} ${e.clickAnimation}`:e.filterActive,children:i}),t.jsx("ul",{className:n?`${e.filterList} ${e.active}`:e.filterList,children:c&&c.map(_=>t.jsx(it,{sortText:i,item:_,onClickItem:s},_.value))})]})]})}function nt({genresData:o,sortData:s,onClickGenre:c,onClickSort:i,isOpenMobileFilter:n}){return t.jsxs("div",{className:n?`${e.filters} ${e.activeMobile}`:e.filters,children:[t.jsx(st,{type:"Жанры",placeholder:"Выбрать жанр",data:o,onClickGenre:c}),t.jsx(ct,{type:"Сортировка",placeholder:"Выбрать сортировку",data:s,onClickSort:i})]})}function rt(){const{sortValue:o,page:s}=p(a=>a.catalog),c=p(a=>a.catalog.genres),{data:i,isFetching:n,isSuccess:r,isLoading:g}=N({page:s,sortValue:o,genres:c.map(a=>a.id)}),u=p(a=>a.favorites.favorites),m=S(),_=F(),l=L(),k=i==null?void 0:i.meta.pagination.total_pages,j=f.useRef();T(()=>setIsOpenSort(!1),j);const[d,x]=f.useState(!1);f.useEffect(()=>()=>{l(b())},[m.isSuccess]);const h=(a,I)=>{l(G({text:I,value:a}))},A=f.useCallback(a=>{l($(a))},[]),C=a=>{l(q(a))};return t.jsx(t.Fragment,{children:t.jsxs("main",{className:`${v.catalog} container`,children:[t.jsx("div",{className:v.catalogLeft,children:t.jsx(B,{data:i==null?void 0:i.data,isLoading:g,isFetching:n,isSuccess:r,dataFavorites:u,count:32})}),t.jsx("div",{className:v.catalogBottom,children:t.jsx(O,{totalPages:k,page:s,onClickPage:A})}),t.jsxs("div",{className:v.rightBlock,children:[t.jsx("div",{className:v.filtersTitle,onClick:()=>x(!d),children:"Фильтры"}),t.jsx(nt,{isOpenMobileFilter:d,genresData:_.data,sortData:m.data,onClickGenre:C,onClickSort:h})]})]})})}export{rt as default};
